(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{16:function(e,t,a){e.exports=a.p+"static/media/logo.5d5d9eef.svg"},18:function(e,t,a){e.exports=a(31)},24:function(e,t,a){},26:function(e,t,a){},31:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),r=a(15),o=a.n(r),i=a(33),u=(a(24),a(4)),c=a(5),l=a(8),m=a(7),g=a(9),h=a(36),d=a(34),p=a(35),E=(a(26),a(2)),f={appId:"3167bd9cb0f2d0",apiKey:"13a262935b4d394f0d1d12f6039c1cbc0f5322e2",GUID:"testgroup"},C=function(){function e(){Object(u.a)(this,e)}return Object(c.a)(e,null,[{key:"init",value:function(){return E.CometChat.init(e.appId)}},{key:"getTextMessage",value:function(e,t,a){return"user"===a?new E.CometChat.TextMessage(e,t,E.CometChat.MESSAGE_TYPE.TEXT,E.CometChat.RECEIVER_TYPE.USER):new E.CometChat.TextMessage(e,t,E.CometChat.MESSAGE_TYPE.TEXT,E.CometChat.RECEIVER_TYPE.GROUP)}},{key:"getLoggedinUser",value:function(){return E.CometChat.getLoggedinUser()}},{key:"login",value:function(e){return console.log(this.apiKey),E.CometChat.login(e,this.apiKey)}},{key:"getGroupMessages",value:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:30,n=(new E.CometChat.MessagesRequestBuilder).setGUID(e).setLimit(a).build();return t(),n.fetchPrevious()}},{key:"sendGroupMessage",value:function(e,t){var a=this.getTextMessage(e,t,"group");return E.CometChat.sendMessage(a)}},{key:"joinGroup",value:function(e){return E.CometChat.joinGroup(e,E.CometChat.GROUP_TYPE.PUBLIC,"")}},{key:"addMessageListener",value:function(e){E.CometChat.addMessageListener(this.LISTENER_KEY_MESSAGE,new E.CometChat.MessageListener({onTextMessageReceived:function(t){e(t)}}))}}]),e}();C.LISTENER_KEY_MESSAGE="msglistener",C.appId=f.appId,C.apiKey=f.apiKey,C.LISTENER_KEY_GROUP="grouplistener";var b=a(16),v=a.n(b),S=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(l.a)(this,Object(m.a)(t).call(this,e))).onSubmit=function(e){""!==a.state.username&&(e.preventDefault(),a.login())},a.login=function(){a.toggleIsSubmitting(),C.login(a.state.username).then(function(e){a.setState({user:e,isAuthenticated:!0}),console.log(a.state.username)}).catch(function(e){a.setState({errorMessage:"Please enter a valid username"}),a.toggleIsSubmitting(),console.log(e)})},a.toggleIsSubmitting=function(){a.setState(function(e){return{isSubmitting:!e.isSubmitting}})},a.handleInput=function(e){a.setState({username:e.target.value})},a.state={username:"",isAuthenticated:!1,user:null,isSubmitting:!1,errorMessage:""},a}return Object(g.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return this.state.isAuthenticated?s.a.createElement(d.a,{to:{pathname:"/chat",state:{user:this.state.user}}}):s.a.createElement("div",{className:"App"},s.a.createElement("h1",null,"COMETCHAT"),s.a.createElement("p",null,"Create an account through your CometChat dashboard or login with one of our test users, superhero1, superhero2, etc."),s.a.createElement("form",{onSubmit:this.onSubmit,className:"form"},s.a.createElement("input",{onChange:this.handleInput,type:"text"}),s.a.createElement("span",{className:"error"},this.state.errorMessage),this.state.isSubmitting?s.a.createElement("img",{src:v.a,alt:"Spinner component",className:"App-logo"}):s.a.createElement("input",{type:"submit",disabled:""===this.state.username,value:"LOGIN"})))}}]),t}(n.Component),M=a(17),T=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(l.a)(this,Object(m.a)(t).call(this,e))).sendMessage=function(){C.sendGroupMessage(a.GUID,a.state.messageText).then(function(e){console.log("Message sent successfully:",e),a.setState({messageText:null})},function(e){"ERR_NOT_A_MEMBER"===e.code&&C.joinGroup(a.GUID).then(function(e){a.sendMessage()})})},a.scrollToBottom=function(){var e=document.getElementById("chatList");e.scrollTop=e.scrollHeight},a.handleSubmit=function(e){e.preventDefault(),a.sendMessage(),e.target.reset()},a.handleChange=function(e){a.setState({messageText:e.target.value})},a.getUser=function(){C.getLoggedinUser().then(function(e){console.log("user details:",{user:e}),a.setState({user:e})}).catch(function(e){"USER_NOT_LOGED_IN"===e.error.code&&a.setState({isAuthenticated:!1})})},a.messageListener=function(){C.addMessageListener(function(e,t){if(t)return console.log("error: ".concat(t));a.setState(function(t){return{groupMessage:[].concat(Object(M.a)(t.groupMessage),[e])}},function(){a.scrollToBottom()})})},a.state={receiverID:"",messageText:null,groupMessage:[],user:{},isAuthenticated:!0},a.GUID=f.GUID,a}return Object(g.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.getUser(),this.messageListener()}},{key:"render",value:function(){var e=this;return this.state.isAuthenticated?s.a.createElement("div",{className:"chatWindow"},s.a.createElement("ul",{className:"chat",id:"chatList"},this.state.groupMessage.map(function(t){return s.a.createElement("div",{key:t.id},e.state.user.uid===t.sender.uid?s.a.createElement("li",{className:"self"},s.a.createElement("div",{className:"msg"},s.a.createElement("p",null,t.sender.uid),s.a.createElement("div",{className:"message"}," ",t.data.text))):s.a.createElement("li",{className:"other"},s.a.createElement("div",{className:"msg"},s.a.createElement("p",null,t.sender.uid),s.a.createElement("div",{className:"message"}," ",t.data.text," "))))})),s.a.createElement("div",{className:"chatInputWrapper"},s.a.createElement("form",{onSubmit:this.handleSubmit},s.a.createElement("input",{className:"textarea input",type:"text",placeholder:"Enter your message...",onChange:this.handleChange})))):s.a.createElement(d.a,{to:"/"})}}]),t}(s.a.Component),I=function(e){function t(e){var a;return Object(u.a)(this,t),a=Object(l.a)(this,Object(m.a)(t).call(this,e)),C.init(),a}return Object(g.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return s.a.createElement(h.a,null,s.a.createElement(d.a,{exact:!0,from:"/",to:"/login"}),s.a.createElement(p.a,{path:"/login",component:S}),s.a.createElement(p.a,{path:"/chat",component:T}))}}]),t}(n.Component);o.a.render(s.a.createElement(i.a,null,s.a.createElement(I,null)),document.getElementById("root"))}},[[18,2,1]]]);
//# sourceMappingURL=main.eb11084c.chunk.js.map