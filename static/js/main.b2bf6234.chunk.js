(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{21:function(e,t,a){e.exports=a.p+"static/media/logo.5d5d9eef.svg"},25:function(e,t,a){e.exports=a(40)},30:function(e,t,a){},31:function(e,t,a){},40:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),r=a(20),o=a.n(r),i=a(13),u=(a(30),a(6)),c=a(7),l=a(10),m=a(9),g=a(11),h=a(8),d=(a(31),a(2)),p={appId:"3167bd9cb0f2d0",apiKey:"13a262935b4d394f0d1d12f6039c1cbc0f5322e2",GUID:"testgroup"},E=function(){function e(){Object(u.a)(this,e)}return Object(c.a)(e,null,[{key:"init",value:function(){return d.CometChat.init(e.appId)}},{key:"getTextMessage",value:function(e,t,a){return"user"===a?new d.CometChat.TextMessage(e,t,d.CometChat.MESSAGE_TYPE.TEXT,d.CometChat.RECEIVER_TYPE.USER):new d.CometChat.TextMessage(e,t,d.CometChat.MESSAGE_TYPE.TEXT,d.CometChat.RECEIVER_TYPE.GROUP)}},{key:"getLoggedinUser",value:function(){return d.CometChat.getLoggedinUser()}},{key:"login",value:function(e){return console.log(this.apiKey),d.CometChat.login(e,this.apiKey)}},{key:"getGroupMessages",value:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:30,n=(new d.CometChat.MessagesRequestBuilder).setGUID(e).setLimit(a).build();return t(),n.fetchPrevious()}},{key:"sendGroupMessage",value:function(e,t){var a=this.getTextMessage(e,t,"group");return d.CometChat.sendMessage(a)}},{key:"joinGroup",value:function(e){return d.CometChat.joinGroup(e,d.CometChat.GROUP_TYPE.PUBLIC,"")}},{key:"addMessageListener",value:function(e){d.CometChat.addMessageListener(this.LISTENER_KEY_MESSAGE,new d.CometChat.MessageListener({onTextMessageReceived:function(t){e(t)}}))}}]),e}();E.LISTENER_KEY_MESSAGE="msglistener",E.appId=p.appId,E.apiKey=p.apiKey,E.LISTENER_KEY_GROUP="grouplistener";var f=a(21),C=a.n(f),b=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(l.a)(this,Object(m.a)(t).call(this,e))).onSubmit=function(e){""!==a.state.username&&(e.preventDefault(),a.login())},a.login=function(){a.toggleIsSubmitting(),E.login(a.state.username).then(function(e){a.setState({user:e,isAuthenticated:!0}),console.log(a.state.username)}).catch(function(e){a.setState({errorMessage:"Please enter a valid username"}),a.toggleIsSubmitting(),console.log(e)})},a.toggleIsSubmitting=function(){a.setState(function(e){return{isSubmitting:!e.isSubmitting}})},a.handleInput=function(e){a.setState({username:e.target.value})},a.state={username:"",isAuthenticated:!1,user:null,isSubmitting:!1,errorMessage:""},a}return Object(g.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return this.state.isAuthenticated?s.a.createElement(h.a,{to:{pathname:"/chat",state:{user:this.state.user}}}):s.a.createElement("div",{className:"App"},s.a.createElement("h1",null,"COMETCHAT"),s.a.createElement("p",null,"Create an account through your CometChat dashboard or login with one of our test users, superhero1, superhero2, etc."),s.a.createElement("form",{onSubmit:this.onSubmit,className:"form"},s.a.createElement("input",{onChange:this.handleInput,type:"text"}),s.a.createElement("span",{className:"error"},this.state.errorMessage),this.state.isSubmitting?s.a.createElement("img",{src:C.a,alt:"Spinner component",className:"App-logo"}):s.a.createElement("input",{type:"submit",disabled:""===this.state.username,value:"LOGIN"})))}}]),t}(n.Component),v=a(24),S=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(l.a)(this,Object(m.a)(t).call(this,e))).sendMessage=function(){E.sendGroupMessage(a.GUID,a.state.messageText).then(function(e){console.log("Message sent successfully:",e),a.setState({messageText:null})},function(e){"ERR_NOT_A_MEMBER"===e.code&&E.joinGroup(a.GUID).then(function(e){a.sendMessage()})})},a.scrollToBottom=function(){var e=document.getElementById("chatList");e.scrollTop=e.scrollHeight},a.handleSubmit=function(e){e.preventDefault(),a.sendMessage(),e.target.reset()},a.handleChange=function(e){a.setState({messageText:e.target.value})},a.getUser=function(){E.getLoggedinUser().then(function(e){console.log("user details:",{user:e}),a.setState({user:e})}).catch(function(e){"USER_NOT_LOGED_IN"===e.error.code&&a.setState({isAuthenticated:!1})})},a.messageListener=function(){E.addMessageListener(function(e,t){if(t)return console.log("error: ".concat(t));a.setState(function(t){return{groupMessage:[].concat(Object(v.a)(t.groupMessage),[e])}},function(){a.scrollToBottom()})})},a.state={receiverID:"",messageText:null,groupMessage:[],user:{},isAuthenticated:!0},a.GUID=p.GUID,a}return Object(g.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.getUser(),this.messageListener()}},{key:"render",value:function(){var e=this;return this.state.isAuthenticated?s.a.createElement("div",{className:"chatWindow"},s.a.createElement("ul",{className:"chat",id:"chatList"},this.state.groupMessage.map(function(t){return s.a.createElement("div",{key:t.id},e.state.user.uid===t.sender.uid?s.a.createElement("li",{className:"self"},s.a.createElement("div",{className:"msg"},s.a.createElement("p",null,t.sender.uid),s.a.createElement("div",{className:"message"}," ",t.data.text))):s.a.createElement("li",{className:"other"},s.a.createElement("div",{className:"msg"},s.a.createElement("p",null,t.sender.uid),s.a.createElement("div",{className:"message"}," ",t.data.text," "))))})),s.a.createElement("div",{className:"chatInputWrapper"},s.a.createElement("form",{onSubmit:this.handleSubmit},s.a.createElement("input",{className:"textarea input",type:"text",placeholder:"Enter your message...",onChange:this.handleChange})))):s.a.createElement(h.a,{to:"/"})}}]),t}(s.a.Component),M=function(e){function t(e){var a;return Object(u.a)(this,t),a=Object(l.a)(this,Object(m.a)(t).call(this,e)),E.init(),a}return Object(g.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return s.a.createElement(h.d,null,s.a.createElement(h.a,{exact:!0,from:"/",to:"/login"}),s.a.createElement(h.b,{path:"/login",component:b}),s.a.createElement(h.b,{path:"/chat",component:S}))}}]),t}(n.Component);o.a.render(s.a.createElement(i.a,null,s.a.createElement(M,null)),document.getElementById("root"))}},[[25,1,2]]]);
//# sourceMappingURL=main.b2bf6234.chunk.js.map